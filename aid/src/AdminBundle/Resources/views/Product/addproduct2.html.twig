{% extends "AdminBundle::Layout/adminlayout.html.twig" %}
{% block title %} Add product {% endblock %}
{% block css %}
<link href="{{asset('bundles/design/')}}css/bootstrape_verticle_tab.min.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="{{asset('bundles/design/')}}plugins/select2/select2.min.css">
<link rel="stylesheet" href="{{asset('bundles/design/')}}plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css">
<link rel="stylesheet" href="{{asset('bundles/design/')}}plugins/iCheck/all.css">
<link rel="stylesheet" href="{{asset('bundles/design/')}}fileupload/css/blueimp-gallery.min.css">
<link rel="stylesheet" href="{{asset('bundles/design/')}}fileupload/css/jquery.fileupload.css">
<link rel="stylesheet" href="{{asset('bundles/design/')}}fileupload/css/jquery.fileupload-ui.css">
 <style>
    .verticle_tab .active a
    {
        background-color: #3fd5af !important;
        color: #FFF !important;
    }
    .verticle_tab a
    {
        color: #000 !important;
    }
    .col-xs-2
    {
        padding-right: 0px !important;
    }
	.select2-container
	{
		 width: 100% !important;
	}
	.desabletab
	{
		 pointer-events: none !important;
		 background-color: #ccc !important;
	}
 </style>
{% endblock %}
{% block content %}
<section class="content-header">
		<h1>
            {% if product_info is defined %}Edit{% else %}Add{% endif %} product
		  <small></small>
		</h1>
		<ol class="breadcrumb">
		  <li><a href="{{path('admin_dashboard_index',{'domain':app.session.get('domain')})}}"><i class="fa fa-dashboard"></i>Dashboard</a></li>
		  <li><a href="{{path('admin_product_index',{'domain':app.session.get('domain')})}}">Product list</a></li>
          <li class="active">Add product</li>
		</ol>
	  </section>
	  <section class="content">
		 {% for flashMessage in app.session.flashbag.get('success_msg') %}
			<div role="alert" class="alert alert-success alert-dismissible fade in">
				 <button aria-label="Close" data-dismiss="alert" class="close" type="button"><span aria-hidden="true">×</span></button>
				 <strong>Alert!</strong>&nbsp; {{ flashMessage }}
		    </div>
	     {% endfor %}
		 {% for flashMessage in app.session.flashbag.get('warning_msg') %}
			<div role="alert" class="alert alert-warning alert-dismissible fade in">
				 <button aria-label="Close" data-dismiss="alert" class="close" type="button"><span aria-hidden="true">×</span></button>
				 <strong>Alert!</strong>&nbsp; {{ flashMessage }}
			</div>
	     {% endfor %}
	     {% for flashMessage in app.session.flashbag.get('error_msg') %}
			<div role="alert" class="alert alert-danger alert-dismissible fade in">
				 <button aria-label="Close" data-dismiss="alert" class="close" type="button"><span aria-hidden="true">×</span></button>
				 <strong>Alert!</strong>&nbsp; {{ flashMessage }}
			</div>
	     {% endfor %}
		 
		<div class="row">
            <div class="col-xs-2">
                <div class="box box-solid">
                    <div class="row">
                        <div class="col-xs-12">
                          <!-- Nav tabs -->
                          <ul class="nav nav-pills tabs-left verticle_tab">
                            <li class="active"><a href="#info" data-toggle="tab">Basic Details</a></li>
							<li><a href="#category" data-toggle="tab">Category</a></li>
                            <li><a href="#media" data-toggle="tab">Media</a></li>
                            <li><a href="#attribute" data-toggle="tab">Attributes</a></li>
                            <li><a href="#feature" data-toggle="tab">Features</a></li>
                            <li><a href="#supplier" data-toggle="tab">Suppliers</a></li>
                            {#<li><a href="#category" {% if product_info is defined and product_info is not empty %}data-toggle="tab" {% else %}class="desabletab"{% endif %}>Category</a></li>
                            <li><a href="#media" {% if product_info is defined and product_info is not empty %}data-toggle="tab" {% else %}class="desabletab"{% endif %}>Media</a></li>
                            <li><a href="#attribute" {% if product_info is defined and product_info is not empty %}data-toggle="tab" {% else %}class="desabletab"{% endif %}>Attributes</a></li>
                            <li><a href="#feature" {% if product_info is defined and product_info is not empty %}data-toggle="tab" {% else %}class="desabletab"{% endif %}>Features</a></li>
                            <li><a href="#supplier" {% if product_info is defined and product_info is not empty %}data-toggle="tab" {% else %}class="desabletab"{% endif %}>Suppliers</a></li>#}
                          </ul>
                        </div>
                    </div>  
                </div>
            </div>
            
            <div class="col-xs-10">
                <div class="box box-solid">
                    <div class="row">
                        <div class="col-xs-12">
                          <!-- Tab panes -->
                            <div class="tab-content">
							  <div class="tab-pane active" id="info">
									{% if language is defined and language is not empty%}
									<ul class="nav nav-pills">
									   {% for lang in language %}
									   <li {% if loop.index == 1 %} class="active"{% endif %}><a href="#basic_{{lang.language_master_id}}" data-toggle="tab">{{lang.language_name}}</a></li>
									   {% endfor %}
									</ul>
									{% endif %}
									
									<div class="tab-content">
									   {% if language is defined and language is not empty%}
										  {% for lang in language %}
										  <div class="tab-pane{% if loop.index == 1 %} active{% endif %}" id="basic_{{lang.language_master_id}}">
										  <form method="post" id="basic_form"  action="{% if product_info is defined and product_info is not empty %}{{path('admin_product_updateproductbasic',{'domain':app.session.get('domain'),'lang_id':lang.language_master_id,'main_product_id':product_info[0].main_product_master_id})}}{% else %}{{path('admin_product_saveproductbasic',{'domain':app.session.get('domain'),'lang_id':lang.language_master_id})}}{% endif %}">
											 <div class="box-body form-horizontal">
												<div class="form-group">
												  <label class="col-sm-2 control-label">Name</label>
												  <div class="col-sm-4">
													<input type="text" class="form-control" name="product_title" value="{% if product_info is defined and product_info is not empty %}{% for product in product_info %}{% if product.language_id == lang.language_master_id %}{{product.product_title}}{% endif %}{% endfor %}{% endif %}">
												  </div>
												</div>
												<div class="form-group">
												  <label class="col-sm-2 control-label">Refrence code</label>
												  <div class="col-sm-5">
													<input type="text" class="form-control" name="refrence_code" value="{% if product_info is defined and product_info is not empty %}{{product_info[0].refrence_code}}{% endif %}">
												  </div>
												</div>
												<div class="form-group">
												  <label class="col-sm-2 control-label">Brand</label>
												  <div class="col-sm-4">
													  <select class="form-control select2" name="brand_id">
														  <option value="">-- select --</option>
														  {% if brand_list is defined and brand_list is not empty %}
															 {% for brand in brand_list %}
																{% if brand.language_id == lang.language_master_id %}
																<option value="{{brand.main_brand_master_id}}" {% if product_info is defined and product_info is not empty and product_info[0].brand_id == brand.main_brand_master_id %}selected{% endif %}>{{brand.brand_name}}</option>
																{% endif %}
															 {% endfor %}
														  {% endif %}
													  </select>
												  </div>
												</div>
												
												<div class="form-group">
												  <label class="col-sm-2 control-label">Price</label>
												  <div class="col-sm-5">
													<input type="text" class="form-control" name="price" value="{% if product_info is defined and product_info is not empty %}{{product_info[0].original_price}}{% endif %}">
												  </div>
												</div>
												
												<div class="form-group">
												  <label class="col-sm-2 control-label">Status</label>
												  <div class="col-sm-5">
													  
														 <label>
														  <input type="radio" class="minimal" name="status" value="active" {% if product_info is defined and product_info is not empty and product_info[0].status == 'active' %}checked{% endif %}>&nbsp;&nbsp; Active
														  </label>
														  &nbsp;&nbsp;&nbsp;&nbsp;
														  <label>
														  <input type="radio" class="minimal" name="status" value="inactive" {% if product_info is defined and product_info is not empty and product_info[0].status == 'inactive' %}checked{% endif %}>&nbsp;&nbsp; Inactive
														  </label>
													  
												  </div>
												</div>
												
												{#<div class="form-group">
												  <label class="col-sm-2 control-label">&nbsp;</label>
												  <div class="col-sm-5">
													  <input type="checkbox" class="minimal">&nbsp;&nbsp; Dispaly the "On sale" icon on product page
												  </div>
												</div>#}
												
												<div class="form-group">
												  <label class="col-sm-2 control-label">Short description</label>
												  <div class="col-sm-10">
													  <textarea class="form-control" name="short_description">{% if product_info is defined and product_info is not empty %}{% for product in product_info %}{% if product.language_id == lang.language_master_id %}{{product.short_description}}{% endif %}{% endfor %}{% endif %}</textarea>
												  </div>
												</div>
												
												<div class="form-group">
												  <label class="col-sm-2 control-label">Description</label>
												  <div class="col-sm-10">
													  <textarea class="form-control" name="description">{% if product_info is defined and product_info is not empty %}{% for product in product_info %}{% if product.language_id == lang.language_master_id %}{{product.description}}{% endif %}{% endfor %}{% endif %}</textarea>
												  </div>
												</div>
											 </div>
											 <div class="box-footer">
												<button type="submit" class="btn btn-default">Cancel</button>
												{% if product_info is defined and product_info is not empty %}
												   <button type="submit" class="btn btn-primary pull-right" name="update_basic_info" value="update_basic_info">Update</button>
												{% else %}
												   <button type="submit" class="btn btn-primary pull-right" name="save_basic_info" value="save_basic_info">Save</button>
												{% endif %}
											</div>
										  </form>	 
										  
										  </div>
										  
										  {% endfor %}
									   {% endif %}
									</div>
								  
								  
								 </div>
                                 <div class="tab-pane" id="category">
									{% macro menu_links(links) %}
									   {% import _self as macros %}
									   {% for link in links %}
										   <li class="collapsed cat{{link.main_category_id}}" >
											   <input type="checkbox"  value="{{ link.main_category_id }}" name="category_selected[]" onclick="set_category_selected('cat{{link.main_category_id}}');"> &nbsp;&nbsp;&nbsp;{{ link.category_name }}
											   {% if link.child_data %}
												   <ul style="list-style-type: none;">
													   {{ macros.menu_links(link.child_data) }}
												   </ul>
											   {% endif %}
										   </li>
									   {% endfor %}
									{% endmacro %}
									{% import _self as macros %}
									{% if language is defined and language is not empty %}
									   <ul class="nav nav-pills">
									   
										   {% for lang in language %}
										   <li {% if loop.index == 1 %}class="active"{% endif %}><a data-toggle="tab" href="#category_tab_{{lang.language_master_id}}">{{lang.language_name}}</a></li>
										   {% endfor %}
										
									   </ul>
									  <div class="tab-content">
									   {% for lang in language %}
									   <div id="category_tab_{{lang.language_master_id}}" class="tab-pane{% if loop.index == 1 %} active{% endif %}">
										   <form method="post" class="form-horizontal" action="{{path('admin_product_saveproductcategory',{'domain':app.session.get('domain')})}}" enctype="multipart/form-data">
											 
											 <div class="box-body">
											   <input type="text" name="language_id"  value="{{lang.language_master_id}}" />
												<input type="text" name="main_product_id"  value="{{lang.language_master_id}}" />
											   <div class="form-group">																  	 <ul style="list-style-type: none;">
													{% for all_final_category in all_final_category %}
													 {%if all_final_category.langauge_id == lang.language_master_id %}
													
													   {%if all_final_category.category_details is not empty %}
														  {% for category_arr in all_final_category.category_details %}
															  <li class="collapsed cat{{category_arr.main_category_id}}" ><input type="checkbox" value="{{category_arr.main_category_id}}" onclick="set_category_selected('cat{{category_arr.main_category_id}}');" name="category_selected[]">&nbsp;&nbsp;&nbsp;<span>{{category_arr.category_name}}</span>
																  {% if category_arr.child_data is defined and category_arr.child_data is not empty %}
																	<ul style="list-style-type: none;">
																	{{ macros.menu_links(category_arr.child_data ) }}
																</ul>
																  {% endif %}
															  </li>
															  
														  {% endfor %}
													   {%else%}
														   No Category Defined
													   {% endif %}
													  {% endif %}
													 {% endfor %}
												  </ul>
											   </div>
											 </div>
											<div class="box-footer">
											   <button type="submit" class="btn btn-default">Cancel</button>
											   <button type="submit" class="btn btn-primary pull-right">Save</button>
										   </div>
										   </form>
		   
									   </div>
									   {% endfor %}
									 </div>
									{% endif %} 
                                  
                                </div>
                                <div class="tab-pane" id="media">
                                    <div class="box-body form-horizontal">
									   {# File upload plugin html code : START #}
									   <form id="fileupload" method="POST" enctype="multipart/form-data">         
										   <div class="row fileupload-buttonbar">
											   <div class="col-lg-7">
												   
												   <span class="btn btn-success fileinput-button">
													   <i class="glyphicon glyphicon-plus"></i>
													   <span>Add files...</span>
													   <input type="file" name="files[]" multiple>
												   </span>
												   <button type="submit" class="btn btn-primary start">
													   <i class="glyphicon glyphicon-upload"></i>
													   <span>Start upload</span>
												   </button>
												   <button type="reset" class="btn btn-warning cancel">
													   <i class="glyphicon glyphicon-ban-circle"></i>
													   <span>Cancel upload</span>
												   </button>
												   <button type="button" class="btn btn-danger delete">
													   <i class="glyphicon glyphicon-trash"></i>
													   <span>Delete</span>
												   </button>
												   <input type="checkbox" class="toggle">
												   <!-- The global file processing state -->
												   <span class="fileupload-process"></span>
											   </div>
										   
											   <div class="col-lg-5 fileupload-progress fade">
												   <!-- The global progress bar -->
												   <div class="progress progress-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100">
													   <div class="progress-bar progress-bar-success" style="width:0%;"></div>
												   </div>
												   <!-- The extended global progress state -->
												   <div class="progress-extended">&nbsp;</div>
											   </div>
										   </div>
									   <table role="presentation" class="table table-striped"><tbody class="files">
										  <!------------------- Temporary gallery ----------------------->
										  {#<tr class="template-download fade in">
											<td>
												<span class="preview">
													<a data-gallery="" download="160429084322e47f1edd5ca04227b115fe4b47786b85.jpeg" title="160429084322e47f1edd5ca04227b115fe4b47786b85.jpeg" href="http://info-07/bwizard/bundles/design/uploads/product_image/160429084322e47f1edd5ca04227b115fe4b47786b85.jpeg">
													  <img src="http://info-07/bwizard/bundles/design/uploads/product_image/thumbnail/160429084322e47f1edd5ca04227b115fe4b47786b85.jpeg">
													</a>
												</span>
											</td>
											<td>
												<p class="name">
													<a data-gallery="" download="160429084322e47f1edd5ca04227b115fe4b47786b85.jpeg" title="160429084322e47f1edd5ca04227b115fe4b47786b85.jpeg" href="http://info-07/bwizard/bundles/design/uploads/product_image/160429084322e47f1edd5ca04227b115fe4b47786b85.jpeg">160429084322e47f1edd5ca04227b115fe4b47786b85.jpeg</a>
												</p>
											</td>
											<td>
												<span class="size">8.95 KB</span>
											</td>
											<td>
												<button data-url="http://info-07/bwizard/bundles/design/index.php?file=160429084322e47f1edd5ca04227b115fe4b47786b85.jpeg" data-type="DELETE" class="btn btn-danger delete">
														<i class="glyphicon glyphicon-trash"></i>
														<span>Delete</span>
													</button>
													<input type="checkbox" class="toggle" value="1" name="delete">
											</td>
										</tr>#}
									<!--------------------------- Temporary gallery --------------------------------->
									   </tbody>
									   </table>
								   </form>
								   {# File upload plugin html code : END #}
								 </div>
								 <div id="blueimp-gallery" class="blueimp-gallery blueimp-gallery-controls" data-filter=":even">
									  <div class="slides"></div>
									  <h3 class="title"></h3>
									  <a class="prev">‹</a>
									  <a class="next">›</a>
									  <a class="close">×</a>
									  <a class="play-pause"></a>
									  <ol class="indicator"></ol>
								  </div>         
                                </div>
                                <div class="tab-pane" id="attribute">
						<!--------------------------- Attribute Tab : START ----------------------------->
									{% if language is defined and language is not empty%}
									   <ul class="nav nav-pills">
										  {% for lang in language %}
										  <li {% if loop.index == 1 %} class="active"{% endif %}><a href="#attr_{{lang.language_master_id}}" data-toggle="tab">{{lang.language_name}}</a></li>
										  {% endfor %}
									   </ul>
									   {% endif %}
									
									<div class="tab-content">
									{% if language is defined and language is not empty%}
										  {% for lang in language %}
										  <div class="tab-pane{% if loop.index == 1 %} active{% endif %}" id="attr_{{lang.language_master_id}}">
											 <div class="box-body form-horizontal">
												
												<form method="post" id="generate_comb_form" action="{{path('admin_product_saveproductattribute',{'domain':app.session.get('domain')})}}"  onsubmit="return check_attr_validation({{lang.language_master_id}})">
												
												 <input type="text" name="language_id"  value="{{lang.language_master_id}}" />
												<input type="text" name="main_product_id"  value="{{lang.language_master_id}}" />
												<div class="form-group">
												  <label class="col-sm-2 control-label">Attribute</label>
												  <div class="col-sm-4">
													 <select class="form-control select" name="attribute" id="attribute_id_{{lang.language_master_id}}" onchange="getAttributevalue(this,{{lang.language_master_id}});">
														 <option value="">Select Attribute</option>
														
														 {% for all_final_category in all_final_category %}
														  {%if all_final_category.langauge_id == lang.language_master_id %}
															{%if all_final_category.attribute_list is not empty %}
															   {%for attr in all_final_category.attribute_list %}
																   <option value="{{attr.main_attribute_id}}">{{attr.public_name}}</option>
															   {% endfor%}
															{% endif %}
														   {% endif %}
														 {% endfor %}
														 
													 </select>
													
												  </div>
												</div>
												<div class="form-group">
												   <label class="col-sm-2 control-label" >Value</label>
												   <div class="col-sm-4">
													  <select class="form-control" id="attrvalue_{{lang.language_master_id}}">
														 <option value="">-- select --</option>
													  </select>
												   </div>
												   <div class="col-sm-4">
													   <input type="button" class="btn btn-sm bg-purple" value="Add"  onclick="addattribute({{lang.language_master_id}})"/ >
												   </div>
												 
												</div>
												<div class="form-group" >
												   <label class="col-sm-2 control-label" >Selected Combinations</label>
												   <div class="col-sm-4" id="selected_attr_value_{{lang.language_master_id}}">
													
												   </div>
												</div>
												<div class="form-group" >
												   <label class="col-sm-2 control-label" ></label>
												   <div class="col-sm-4">
													    <input type="submit" class="btn btn-success" value="Generate" >
												   </div>
												</div>
												</form>
												
												<label><h4>Attribute combinations</h4></label>
												<table class="table table-bordered">
												   <tbody><tr>
													 <th style="width: 10px">#</th>
													 <th>Attribute - value pair</th>
													 <th>Impact on price</th>
													 <th>Refrence</th>
													 <th style="width: 40px">Label</th>
												   </tr>
												   <tr>
													 <td></td>
													 <td></td>
													 <td></td>
													 <td></td>
													 <td></td>
												   </tr>
												 </tbody>
												</table>
											 </div>
											 <div class="box-footer">
											   <button type="submit" class="btn btn-default">Cancel</button>
											   <button type="submit" class="btn btn-primary pull-right">Save</button>
										     </div>
										  </div>
										  {% endfor %}
									{% endif %}
									</div>
					    <!--------------------------- Attribute Tab : END ----------------------------->	 
                                </div>
								<div class="tab-pane" id="feature">
                                    <div class="box-body form-horizontal">
                                       feature
                                    </div>
                                </div>
								<div class="tab-pane" id="feature">
                                    <div class="box-body form-horizontal">
                                       supplier
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>  
                </div>
            </div>
        </div>    
</section>
{% endblock %}
{% block js %}
<script id="template-upload" type="text/x-tmpl">
{% verbatim %}
{% for (var i=0, file; file=o.files[i]; i++) { %}
    <tr class="template-upload fade">
        <td>
            <span class="preview"></span>
        </td>
        <td>
            <p class="name">{%=file.name%}</p>
            <strong class="error text-danger"></strong>
        </td>
        <td>
            <p class="size">Processing...</p>
            <div class="progress progress-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0"><div class="progress-bar progress-bar-success" style="width:0%;"></div></div>
        </td>
        <td>
            {% if (!i && !o.options.autoUpload) { %}
                <button class="btn btn-primary start" disabled>
                    <i class="glyphicon glyphicon-upload"></i>
                    <span>Start</span>
                </button>
            {% } %}
            {% if (!i) { %}
                <button class="btn btn-warning cancel">
                    <i class="glyphicon glyphicon-ban-circle"></i>
                    <span>Cancel</span>
                </button>
            {% } %}
        </td>
    </tr>
{% } %}
{% endverbatim %}
</script>
<!-- The template to display files available for download -->
<script id="template-download" type="text/x-tmpl">
{% verbatim %}

{% endverbatim %}
</script>
<script src="{{asset('bundles/design/')}}plugins/select2/select2.full.min.js"></script>
<script src="{{asset('bundles/design/')}}plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js"></script>
<script src="{{asset('bundles/design/')}}plugins/select2/select2.full.min.js"></script>
<script src="{{asset('bundles/design/')}}plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js"></script>
<script language="Javascript" src="{{asset('bundles/design/')}}tinymce/tinymce.min.js" type="text/javascript"></script>
<script src="{{asset('bundles/design/')}}plugins/iCheck/icheck.min.js"></script>

<script src="{{asset('bundles/design/')}}fileupload/js/jquery.ui.widget.js"></script>
<!-- The Templates plugin is included to render the upload/download listings -->
<script src="{{asset('bundles/design/')}}fileupload/js/tmpl.min.js"></script>
<!-- The Load Image plugin is included for the preview images and image resizing functionality -->
<script src="{{asset('bundles/design/')}}fileupload/js/load-image.all.min.js"></script>
<!-- The Canvas to Blob plugin is included for image resizing functionality -->
<script src="{{asset('bundles/design/')}}fileupload/js/canvas-to-blob.min.js"></script>
<!-- blueimp Gallery script -->
<script src="{{asset('bundles/design/')}}fileupload/js/jquery.blueimp-gallery.min.js"></script>
<!-- The Iframe Transport is required for browsers without support for XHR file uploads -->
<script src="{{asset('bundles/design/')}}fileupload/js/jquery.iframe-transport.js"></script>
<!-- The basic File Upload plugin -->
<script src="{{asset('bundles/design/')}}fileupload/js/jquery.fileupload.js"></script>
<!-- The File Upload processing plugin -->
<script src="{{asset('bundles/design/')}}fileupload/js/jquery.fileupload-process.js"></script>
<!-- The File Upload image preview & resize plugin -->
<script src="{{asset('bundles/design/')}}fileupload/js/jquery.fileupload-image.js"></script>
<!-- The File Upload audio preview plugin -->
<script src="{{asset('bundles/design/')}}fileupload/js/jquery.fileupload-audio.js"></script>
<!-- The File Upload video preview plugin -->
<script src="{{asset('bundles/design/')}}fileupload/js/jquery.fileupload-video.js"></script>
<!-- The File Upload validation plugin -->
<script src="{{asset('bundles/design/')}}fileupload/js/jquery.fileupload-validate.js"></script>
<!-- The File Upload user interface plugin -->
<script src="{{asset('bundles/design/')}}fileupload/js/jquery.fileupload-ui.js"></script>
<!-- The main application script -->
{#<script src="{{asset('bundles/design/')}}fileupload/js/main.js"></script>#}
<script>
$("#basic_form").validate({
	  rules: {
		  product_title: "required",
		  refrence_code: "required",
		  brand_id: "required",
		  status: "required",
		  price: {
			  required: true,
			  number: true
		  }
	  },
	  messages: {
		  product_title: "Please enter product title",
		  refrence_code: "Please enter refrence code",
		  brand_id: "Please select brand",
		  status: "Please select status",
		  price: {
			  required: "Please enter a product price",
			  number: "Only numbers allowed"
		  }
	  }
  });

$(function () {
var html = "";
    'use strict';
    // Initialize the jQuery File Upload widget:
    $('#fileupload').fileupload({
        // Uncomment the following to send cross-domain cookies:
        xhrFields: {withCredentials: true},
        url: '{{live_path}}/bundles/design/index.php?temp_dir=product_image',
		success: function(response)
		{
		    //console.log(response.files[0]);
			//database insert ajax
			$.ajax({
			type: 'POST',
			url : "{{ path('admin_userrole_saveproductgallery',{'domain':app.session.get('domain')}) }}",
			data: {"img_name":response.files[0].name,'main_product_id':1,'media_type_id':1,'flag':'save_gallery_image'},
			async: true,
			dataType: 'json',
			success: function(response){
					 
					 if (response != false)
					 {
						   html += '<tr class="template-download fade in">';
							  html += '<td>';
								  html += '<span class="preview">';
									  html += '<a data-gallery="" download="'+response.name+'" title="'+response.name+'" href="'+response.path+'">';
										html += '<img src="'+response.thumbnail_path+'">';
									  html += '</a>';
								  html += '</span>';
							  html += '</td>';
							  html += '<td>';
								  html += '<p class="name">';
									  html += '<a data-gallery="" download="'+response.name+'" title="'+response.name+'" href="'+response.path+'">'+response.name+'</a>';
								  html += '</p>';
							  html += '</td>';
							  html += '<td>';
								  html += '<button class="btn btn-danger delete">';
										  html += '<i class="glyphicon glyphicon-trash"></i>';
										  html += '<span>Delete</span>';
									  html += '</button>';
									  html += '<input type="checkbox" class="toggle" value="1" name="delete">';
							  html += '</td>';
						  html += '</tr>';
						  
						  $(".files").append(html);
                     }
					 
			   }
			});
	    }
    });
});

</script>
<script language="Javascript" type="text/javascript">
tinymce.init({
    selector: "textarea",
	max_chars : 1000,
	width:      '100%',
	height:     '50%',
    plugins: [
        "advlist autolink lists link charmap print preview anchor",
        "searchreplace visualblocks code",
        "insertdatetime table contextmenu paste moxiemanager",
		"textcolor"
    ],
    statusbar:  true,
	menubar:    true,
    toolbar: "sizeselect | fontselect |  fontsizeselect | forecolor backcolor | undo redo | bold underline italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link",

	rel_list:   [ { title: 'Lightbox', value: 'lightbox' } ]
});
// A $( document ).ready() block.
$( document ).ready(function() {
  $('input[type=checkbox]').click(function(){
    // if is checked
    if($(this).is(':checked')){
        // check all children
        $(this).parent().find('li input[type=checkbox]').prop('checked', true);
        // check all parents
        $(this).parent().prev().prop('checked', true);
    } else {
        // uncheck all children
        $(this).parent().find('li input[type=checkbox]').prop('checked', false);
    }

});
});
function validate(){

	var textarea = tinymce.get('description').getContent();
	if ( (textarea=="") || (textarea==null) ) {
        tinymce.get('description').focus();
		return false; 
	}
	return true;
}
function set_category_selected(clsname) {}

function check_attr_validation(langid) {
   var flag = 'true';
   var slected_attr = '' ;
   var slctvalue = $('.attr_selected_vals_'+langid);
   $.each($('.attr_selected_ids_'+langid), function(i, item){
	  if (slected_attr == '') {
		slected_attr += $(this).val() + ":"+ $(slctvalue[i]).val() ;
	  }
	  else{
		slected_attr += ","+ $(this).val() + ":"+ $(slctvalue[i]).val() ;
	  }		
   });
  
   {#var url =  "{{path('admin_product_checkattributevalue',{'domain':app.session.get('domain'),'attribute_arr':'slected_attr_text','language_id':'lang1'})}}";#}
   url = url.replace("slected_attr_text", slected_attr);
   url = url.replace("lang1", langid);
   $.ajax({	 
	   url:url,
	   success: function(result){
		 
	   }
   });
  
}
function addattribute(langid) {
   attr_id = $('#attribute_id_'+langid).val();
   attr_text =  $('#attribute_id_'+langid+' option:selected').text();
   attr_val =  $('#attrvalue_'+langid).val();
   attrval_text =  $('#attrvalue_'+langid+' option:selected').text();
   if (attr_id == '' || attr_val == '' || attr_id == '0' || attr_val == 0) {
	  alert("Please Select Attribute and Values");
   }
   else{
	   var flag = 'true';
	   $.each($('.attr_selected_ids_'+langid), function(i, item) {
			if($(this).val() == attr_id){
			    flag = 'false';
			}
		});
	   if (flag =='true') {
         var html = '';
		 html += "<div class='well well-sm'>";
		 html += "<a onclick='$(this).parent().remove();' class='pull-right btn btn-xs btn-warning'><span class='fa fa-remove'></span></a>";
		 html += "<label>"+attr_text+"</label><input type='hidden' class='attr_selected_ids_"+langid+"' name='attr_selected_ids_"+langid+"[]' value='"+attr_id+"'/>:";
		 html +=  ""+attrval_text+"<input type='hidden' class='attr_selected_vals_"+langid+"' name='attr_selected_vals_"+langid+"[]' value='"+attr_val+"'/>";
		 html += "</div>";
		 
		 $('#selected_attr_value_'+langid).append(html);
       }
	   else{
		 alert("You can add only one combination per attribute type.")
	   }
	
    //code
   }
}
function getAttributevalue(aid,lang) {  
   attridjs = $(aid).val() ;
   langidjs = lang ;
   if (attridjs != 0) {
      var url =  "{{path('admin_product_getattributevalue',{'domain':app.session.get('domain'),'attribute_id':'attrid','language_id':'lang1'})}}";
	  url = url.replace("attrid", attridjs);
	  url = url.replace("lang1", langidjs);
	   $.ajax({	 
		 url:url,
		 success: function(result){
			var obj = jQuery.parseJSON( result );
			$('#attrvalue_'+langidjs).html('');
			$('#attrvalue_'+langidjs).append($('<option>', {
				  value: 0,
				  text: 'Select'
			}));
			for (var i = 0 ; i < obj.length ; i++ ) {
			   console.log(obj[i]);  //code
			   $('#attrvalue_'+langidjs).append($('<option>', {
				 value: obj[i].main_attribute_value_id,
				 text: obj[i].attribute_value
			   }));
			}
		 }
	  });
   }
   else{
	  $('#attrvalue_'+langidjs).html('');
	  $('#attrvalue_'+langidjs).append($('<option>', {
			value: 0,
			text: 'Select'
	  }));
   }
}
</script>
<script>
$(function () {
   $(".select2").select2();
   $(".editor").wysihtml5();
});
$('input[type="checkbox"].minimal, input[type="radio"].minimal').iCheck({
checkboxClass: 'icheckbox_minimal-blue',
radioClass: 'iradio_minimal-blue'
});
</script>
{% endblock %}