{% extends "AdminBundle::Layout/adminlayout.html.twig" %}
{% block title %} Delivery Boywise {% endblock %}
{% block css %}
	
	<link href="{{asset('bundles/design/')}}plugins/bootstrape3_datetime_picker/css/bootstrap-datetimepicker.min.css" rel="stylesheet" type="text/css" />
	{#<link href="{{asset('bundles/design/')}}plugins/datepicker/datepicker3.css" rel="stylesheet" type="text/css" />#}

{% endblock %}
{% block content %}
	  
	<section class="content-header" style="padding: 26px 16px 0px 0px;">
		  <small></small>

		<ol class="breadcrumb">
		  <li><a href="{{path('admin_dashboard_index',{'domain':app.session.get('domain')})}}"><i class="fa fa-dashboard"></i>Dashboard</a></li>
		  <li class="active">Delivery Boywise</li>
		</ol>
	  </section>
	  <section class="content">
		<div class ="row">
			<div class="col-md-12">
			{% for flashMessage in app.session.flashbag.get('success_msg') %}
			  <div class="alert alert-success alert-dismissable">
				  <button aria-hidden="true" data-dismiss="alert" class="close" type="button">×</button>
				  <h4><i class="icon fa fa-check"></i> Alert!</h4>{{ flashMessage }}
			  </div>
			  {% endfor %}
			  {% for flashMessage in app.session.flashbag.get('error_msg') %}
			  <div class="alert alert-danger alert-dismissable">
				  <button aria-hidden="true" data-dismiss="alert" class="close" type="button">×</button>
				  <h4><i class="icon fa fa-check"></i> Alert!</h4>{{ flashMessage }}
			  </div>
			{% endfor %}
			</div>  
		</div>
		<div class="row">
			<div class="col-xs-12">
                <div class="form-group">
				  <form class="form" action="{{path('admin_report_deliveryboywise',{'domain':app.session.get('domain')})}}" method="post">
				<label class="control-label col-xs-1">Start Date</label>
				<div class="col-xs-3">
					<div class="input-group date">
						<input type="text" name="fromdate" id="fromdate" class="form-control" value="" required />
						<div class="input-group-addon">
							<span class="glyphicon glyphicon-calendar"></span>
						</div>
					</div>
				</div>
			    
				<label class="control-label col-xs-1">End Date</label>
				<div class="col-xs-3">
					<div class="input-group date">
						<input type="text" name="todate" id="todate" class="form-control" value="" required />
						<div class="input-group-addon">
							<span class="glyphicon glyphicon-calendar"></span>
						</div>
					</div>
				</div>
				  
                      {#<label class="control-label col-xs-2">To Date</label>
                      <div class="col-xs-3">
                            <input type="text" name="todate" id="todate" readonly class="form-control date" />
                      </div>#}
                      <input type="hidden" id="domain_id" value="{% if app.session.get('domain_id') is defined and app.session.get('domain_id') != "" %}{{app.session.get('domain_id')}}{% endif %}">
                      <div class="col-xs-2">
                            <button type="submit" name="search" id="search" class="btn btn-primary btn-flat" data-loading-text="<i class='fa fa-circle-o-notch fa-spin'></i> Loading..." onclick="getReport();">Search</button>
							
                      </div>
                </div>
				</form>
		    
		</div>
		
		</div><br>
		<div class="row">
			<div class="col-xs-12">
                <div class="box box-solid">
                    <div class="box-header with-border">
                      <h3 class="box-title">Delivery Boywise <span id="spnReportDate"></span></h3></h3>
                      <div class="pull-right">
                        {#<a href="{{path('admin_healthtips_addhealthtip',{'domain':app.session.get('domain')})}}" class="btn btn-primary btn-flat"><i class="fa fa-plus"></i>&nbsp;&nbsp;ADD</a>#}
                      </div>
                    </div>
                    <div class="box-body">
						<div class="row">
							  <div class="col-sm-12">
									<div class="col-sm-3">
										  <div class="progress">
												<div class="progress-bar progress-bar-success" role="progressbar" style="width:100%">
													  For 80% and 80% UP Ordres
												</div>
										  </div>
									</div>
									<div class="col-sm-3">
										  <div class="progress">
												<div class="progress-bar progress-bar-info" role="progressbar" style="width:100%">
													  For 60% to 79% Orders
												</div>
										  </div>
									</div>
									<div class="col-sm-3">
										  <div class="progress">
												<div class="progress-bar progress-bar-warning" role="progressbar" style="width:100%">
													  For 40% to 59% Orders
												</div>
										  </div>
									</div>
									<div class="col-sm-3">
										  <div class="progress">
												<div class="progress-bar progress-bar-danger" role="progressbar" style="width:100%">
													  For 40% Down Orders
												</div>
										  </div>
									</div>	  
							  </div>
						</div>
                        <div class="container-fluid table-responsive">
							<table id="example1" class="table table-bordered table-striped text-center">
								<thead>
									<th style="width: 3%">#</th>
									<th style="width: 15%">DeliveryBoy Name</th>
									<th style="width: 12%">Total Orders</th>
									<th style="width: 10%">Placed</th>
									<th style="width: 12%">In progress</th>
									<th style="width: 10%">Delivered</th>
									<th style="width: 10%">Canceled</th>
									<th style="width: 40%">Progress</th>
								</thead>
								<tbody>
									{% if delivery_boy_progress is defined and delivery_boy_progress is not empty %}
										  {% for delivery_boy_progress in delivery_boy_progress %}
												<tr>
													  <td>{{loop.index}}</td>
													  <td>{{delivery_boy_progress.user_firstname}} {{delivery_boy_progress.user_lastname}}</td>
													  <td>{{delivery_boy_progress.delivery_boy_order_count}}</td>
													  <td>{{delivery_boy_progress.orders_status[0].order_status_count}}</td>
													  <td>{{delivery_boy_progress.orders_status[1].order_status_count}}</td>
													  <td>{{delivery_boy_progress.orders_status[2].order_status_count}}</td>
													  <td>{{delivery_boy_progress.orders_status[3].order_status_count}}</td>
													  <td>
															{% if delivery_boy_progress.progress >= 80  %}
																  {% set spstatus = "success" %}
															{% elseif delivery_boy_progress.progress >= 60  and delivery_boy_progress.progress < 79 %}
																  {% set spstatus="info" %}
															{% elseif delivery_boy_progress.progress >= 40  and delivery_boy_progress.progress < 59 %}
																  {% set spstatus="warning" %}
															{% else %}
																  {% set spstatus="danger" %}
															{% endif %}
															<div class="progress progress-xs" style="height: 11px;">
																  <div style="width:{{delivery_boy_progress.progress}}%" class="progress-bar progress-bar-{{spstatus}}"></div>
															</div>
													  </td>
												</tr>
										  {% endfor %}
									{%endif %}
								</tbody>
								<tfoot>
									<th>#</th>
									<th>DeliveryBoy Name</th>
									<th>Total Orders</th>
									<th>Progress</th>
									<th>Placed</th>
									<th>In progress</th>
									<th>Delivered</th>
									<th>Canceled</th>
								</tfoot>
							</table>
						</div>

                    </div>
                  </div>
            </div>
		</div>
	  </section>
{% endblock %}

{% block js %}
	  <script src="{{asset('bundles/design/')}}plugins/daterangepicker/moment.min.js" type="text/javascript"></script>
<script src="{{asset('bundles/design/')}}plugins/bootstrape3_datetime_picker/js/bootstrap-datetimepicker.min.js" type="text/javascript"></script>
{#<script src="{{asset('bundles/design/')}}plugins/datepicker/bootstrap-datepicker.js" type="text/javascript"></script>#}
<script src="{{asset('bundles/design/')}}table-to-excel/src/jquery.table2excel.js" type="text/javascript"></script>


<script>
$(function () {			
var today = new Date();
var startDate = new Date(today.getFullYear(), today.getMonth(0),  1);
var lastDate = new Date(today.getFullYear(), today.getMonth(0),  15);
	$('#fromdate').datetimepicker();
	$('#todate').datetimepicker({
		useCurrent: false//Important! See issue #1075
	});
	$("#fromdate").on("dp.change", function (e) {
		$('#todate').data("DateTimePicker").minDate(e.date);
	});
	$("#todate").on("dp.change", function (e) {
		$('#fromdate').data("DateTimePicker").maxDate(e.date);
	});
});

$(function () {
	var starting_date = "{{fromdate}}" ;
	var ending_date = "{{todate}}" ;
	  $("#spnReportDate").html("- From <b>"+starting_date+"</b> to <b>"+ending_date+"</b>");
	  document.title = $("#Reportheader").text();
});
</script>
{% endblock %}